head(HairEyeColor)
df <- as.data.frame.table(HairEyeColor)
df
df |>
ggplot(aes(x = Eye, y = Freq, fill = Sex, label = Freq)) +
geom_col(alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Sex, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
group_by(Hair) |>
mutate(Chk = max(Freq) == Freq) |>
ggplot(aes(x = Eye, y = Freq, label = Freq, group = Sex)) +
geom_col(aes(fill = Chk), color = "white", alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Chk, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
scale_fill_manual(values = c("gray80","coral")) +
scale_color_manual(values = c("gray80", "coral")) +
theme_bw()
df |>
filter(Sex == "Male") |>
group_by(Hair) |>
mutate(Ratio = Freq / sum(Freq)) |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Ratio)) +
geom_col(alpha = 0.8) +
# geom_text(aes(label = paste(round(Ratio*100,1), "%"), color = Hair), vjust = -0.1) +
geom_text(aes(label = paste0(scales::percent(round(Ratio,3)),"\n","(",Freq,")"), color = Hair),
vjust = -0.2, hjust = 0.5, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
ggsave("image.png")
sessionInfo()
graphics.off()
rm(list = ls())
gc()
library(tidyverse)
library(scales)
head(HairEyeColor)
df <- as.data.frame.table(HairEyeColor)
df
df |>
ggplot(aes(x = Eye, y = Freq, fill = Sex, label = Freq)) +
geom_col(alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Sex, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
group_by(Hair) |>
mutate(Chk = max(Freq) == Freq) |>
ggplot(aes(x = Eye, y = Freq, label = Freq, group = Sex)) +
geom_col(aes(fill = Chk), color = "white", alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Chk, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
scale_fill_manual(values = c("gray80","coral")) +
scale_color_manual(values = c("gray80", "coral")) +
theme_bw()
df |>
filter(Sex == "Male") |>
group_by(Hair) |>
mutate(Ratio = Freq / sum(Freq)) |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Ratio)) +
geom_col(alpha = 0.8) +
# geom_text(aes(label = paste(round(Ratio*100,1), "%"), color = Hair), vjust = -0.1) +
geom_text(aes(label = paste0(scales::percent(round(Ratio,3)),"\n","(",Freq,")"), color = Hair),
vjust = -0.2, hjust = 0.5, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
ggsave("image.png")
sessionInfo()
graphics.off()
rm(list = ls())
gc()
library(tidyverse)
library(scales)
head(HairEyeColor)
df <- as.data.frame.table(HairEyeColor)
df
df |>
ggplot(aes(x = Eye, y = Freq, fill = Sex, label = Freq)) +
geom_col(alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Sex, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
group_by(Hair) |>
mutate(Chk = max(Freq) == Freq) |>
ggplot(aes(x = Eye, y = Freq, label = Freq, group = Sex)) +
geom_col(aes(fill = Chk), color = "white", alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Chk, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
scale_fill_manual(values = c("gray80","coral")) +
scale_color_manual(values = c("gray80", "coral")) +
theme_bw()
df |>
filter(Sex == "Male") |>
group_by(Hair) |>
mutate(Ratio = Freq / sum(Freq)) |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Ratio)) +
geom_col(alpha = 0.8) +
# geom_text(aes(label = paste(round(Ratio*100,1), "%"), color = Hair), vjust = -0.1) +
geom_text(aes(label = paste0(scales::percent(round(Ratio,3)),"\n","(",Freq,")"), color = Hair),
vjust = -0.2, hjust = 0.5, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
ggsave("image.png")
sessionInfo()
graphics.off()
rm(list = ls())
gc()
library(tidyverse)
library(scales)
head(HairEyeColor)
df <- as.data.frame.table(HairEyeColor)
df |> head()
df |>
ggplot(aes(x = Eye, y = Freq, fill = Sex, label = Freq)) +
geom_col(alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Sex, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
group_by(Hair) |>
mutate(Chk = max(Freq) == Freq) |>
ggplot(aes(x = Eye, y = Freq, label = Freq, group = Sex)) +
geom_col(aes(fill = Chk), color = "white", alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Chk, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
scale_fill_manual(values = c("gray80","coral")) +
scale_color_manual(values = c("gray80", "coral")) +
theme_bw()
df |>
filter(Sex == "Male") |>
group_by(Hair) |>
mutate(Ratio = Freq / sum(Freq)) |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Ratio)) +
geom_col(alpha = 0.8) +
# geom_text(aes(label = paste(round(Ratio*100,1), "%"), color = Hair), vjust = -0.1) +
geom_text(aes(label = paste0(scales::percent(round(Ratio,3)),"\n","(",Freq,")"), color = Hair),
vjust = -0.2, hjust = 0.5, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
ggsave("image.png")
sessionInfo()
graphics.off()
rm(list = ls())
gc()
library(tidyverse)
library(scales)
head(HairEyeColor)
df <- as.data.frame.table(HairEyeColor)
df |> head()
df |>
ggplot(aes(x = Eye, y = Freq, fill = Sex, label = Freq)) +
geom_col(alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Sex, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
group_by(Hair) |>
mutate(Chk = max(Freq) == Freq) |>
ggplot(aes(x = Eye, y = Freq, label = Freq, group = Sex)) +
geom_col(aes(fill = Chk), color = "white", alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Chk, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
scale_fill_manual(values = c("gray80","coral")) +
scale_color_manual(values = c("gray80", "coral")) +
theme_bw()
df |>
filter(Sex == "Male") |>
group_by(Hair) |>
mutate(Ratio = Freq / sum(Freq)) |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Ratio)) +
geom_col(alpha = 0.8) +
# geom_text(aes(label = paste(round(Ratio*100,1), "%"), color = Hair), vjust = -0.1) +
geom_text(aes(label = paste0(scales::percent(round(Ratio,3)),"\n","(",Freq,")"), color = Hair),
vjust = -0.2, hjust = 0.5, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
ggsave("image.png")
sessionInfo()
sessionInfo() |> summary()
sessionInfo()
version()
version
graphics.off()
rm(list = ls())
gc()
library(tidyverse)
library(scales)
head(HairEyeColor)
df <- as.data.frame.table(HairEyeColor)
df |> head()
df |>
ggplot(aes(x = Eye, y = Freq, fill = Sex, label = Freq)) +
geom_col(alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Sex, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
group_by(Hair) |>
mutate(Chk = max(Freq) == Freq) |>
ggplot(aes(x = Eye, y = Freq, label = Freq, group = Sex)) +
geom_col(aes(fill = Chk), color = "white", alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Chk, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
scale_fill_manual(values = c("gray80","coral")) +
scale_color_manual(values = c("gray80", "coral")) +
theme_bw()
df |>
filter(Sex == "Male") |>
group_by(Hair) |>
mutate(Ratio = Freq / sum(Freq)) |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Ratio)) +
geom_col(alpha = 0.8) +
# geom_text(aes(label = paste(round(Ratio*100,1), "%"), color = Hair), vjust = -0.1) +
geom_text(aes(label = paste0(scales::percent(round(Ratio,3)),"\n","(",Freq,")"), color = Hair),
vjust = -0.2, hjust = 0.5, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
ggsave("image.png")
version
graphics.off()
rm(list = ls())
gc()
version
library(tidyverse)
library(scales)
head(HairEyeColor)
df <- as.data.frame.table(HairEyeColor)
df |> head()
df |>
ggplot(aes(x = Eye, y = Freq, fill = Sex, label = Freq)) +
geom_col(alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Sex, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
group_by(Hair) |>
mutate(Chk = max(Freq) == Freq) |>
ggplot(aes(x = Eye, y = Freq, label = Freq, group = Sex)) +
geom_col(aes(fill = Chk), color = "white", alpha = 0.8, position = "dodge", show.legend = FALSE) +
geom_text(aes(color = Chk, group = Sex), position = position_dodge(width = 1), vjust = -0.1, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
scale_fill_manual(values = c("gray80","coral")) +
scale_color_manual(values = c("gray80", "coral")) +
theme_bw()
df |>
filter(Sex == "Male") |>
group_by(Hair) |>
mutate(Ratio = Freq / sum(Freq)) |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Ratio)) +
geom_col(alpha = 0.8) +
# geom_text(aes(label = paste(round(Ratio*100,1), "%"), color = Hair), vjust = -0.1) +
geom_text(aes(label = paste0(scales::percent(round(Ratio,3)),"\n","(",Freq,")"), color = Hair),
vjust = -0.2, hjust = 0.5, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair, strip.position = c("right")) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
df |>
filter(Sex == "Female") |>
ggplot(aes(x = Eye, y = Freq, fill = Hair, label = Freq)) +
geom_col(alpha = 0.8) +
geom_point(color = "white", size = 4, show.legend = FALSE) +
geom_point(aes(color = Hair), size = 2, show.legend = FALSE) +
geom_path(aes(group = Hair, color = Hair), lty = 2, linewidth = 1, show.legend = FALSE) +
geom_text(aes(color = Hair), vjust = -1.0, show.legend = FALSE) +
labs(title = "Hair and Eye Color of Statistics Students",
subtitle = "Distribution of hair and eye color and sex in 592 statistics students.",
x = "Eye Color", y = "Frequency") +
facet_wrap(~ Hair) +
scale_y_continuous(limits = c(0,80), breaks = seq(0,80,20)) +
theme_bw()
ggsave("image.png")
