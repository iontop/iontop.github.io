graphics.off()
rm(list = ls())
gc()
version
library(tidyverse)
faithful |> head()
class(faithful)
dim(faithful)
df <- faithful
df |>
ggplot(aes(waiting, eruptions)) +
geom_point()
df |>
ggplot(aes(waiting, eruptions, color = waiting)) +
geom_point()
df |>
mutate(waitLv = cut_number(waiting, 4)) |>
ggplot(aes(waiting, eruptions, color = waitLv)) +
geom_point()
# Calculate slope and intercept of line of best fit
linear <- lm(eruptions ~ waiting, data = faithful)
linear
linear$coefficients[1]
i <- linear$coefficients[1]
linear$coefficients[2]
s <- linear$coefficients[2]
df |>
mutate(waitLv = cut_number(waiting, 4)) |>
ggplot(aes(waiting, eruptions, color = waitLv)) +
geom_point() +
geom_abline(intercept = i, slope = s)
df |>
mutate(waitLv = cut_number(waiting, 4)) |>
ggplot(aes(waiting, eruptions)) + # Should remove "aes(color = waitLv)" in ggplot()
geom_point(aes(color = waitLv)) +
geom_smooth(method = lm ,se = FALSE, color = "black", linewidth = 0.5) # BUT!! to extract equation you should using "lm()"
df |>
mutate(waitLv = cut_number(waiting, 4)) |>
ggplot(aes(waiting, eruptions, color = waitLv)) +
geom_point() +
geom_abline(intercept = i, slope = s, color = "blue", lty = 2) +
annotate("text",x = 50, y = 4.5, label = paste0("y = ", round(s,5) ,"x +",round(i,5))) +
labs(title = "Old Faithful geyser",
subtitle = paste0("Waiting time between eruptions and the duration of the eruption for the Old Faithful geyser","\n",
"in Yellowstone National Park, Wyoming, USA."),
x = "Waiting time to next eruption (min)", y = "Eruption time (min)", color = "Lv. of Wating Time") +
theme_bw() +
theme(legend.position = "bottom")
ggsave("image.png")
graphics.off()
rm(list = ls())
gc()
version
library(tidyverse)
library(tsibble)
library(gghighlight)
Nile
class(Nile)
#coerce ts to tsibble
df <- as_tsibble(Nile)
df |> head()
class(df)
dim(df)
colnames(df) <- c("year", "flow")
df |> head()
df |>
ggplot(aes(year, flow)) +
geom_line()
df1 <-
df |>
mutate(grp = cut_number(year, 2, labels = FALSE),
lag = difference(flow, default = 0))
df1
df1 |>
ggplot(aes(year)) +
geom_area(aes(y = flow), fill = "midnightblue") +
geom_area(aes(y = lag), fill = "orange")
df1 |>
ggplot(aes(year)) +
geom_area(aes(y = flow), fill = "midnightblue") +
geom_area(aes(y = lag), fill = "orange") +
facet_wrap(vars(grp), ncol = 1)
grp_status <- c( "1" = "First 50years", "2" = "Second 50years")
df1 |>
ggplot(aes(year)) +
geom_area(aes(y = flow), fill = "midnightblue") +
geom_area(aes(y = lag), fill = "orange") +
facet_wrap(vars(grp), ncol = 1, scale = "free_x", labeller = labeller(grp = grp_status))
df1 |>
ggplot(aes(year)) +
geom_area(aes(y = flow, fill = "Flow")) +
geom_area(aes(y = lag, fill = "Lag")) +
facet_wrap(vars(grp), ncol = 1, scale = "free_x", labeller = labeller(grp = grp_status)) +
scale_fill_manual(name = "Legend", values = c("Flow" = "midnightblue", "Lag" = "orange"))
df1 |>
ggplot(aes(year)) +
geom_area(aes(y = flow, fill = "Flow")) +
geom_area(aes(y = lag, fill = "Lag")) +
facet_wrap(vars(grp), ncol = 1, scale = "free_x", labeller = labeller(grp = grp_status)) +
scale_fill_manual(name = "Legend", values = c("Flow" = "midnightblue", "Lag" = "orange")) +
labs(title = "Flow of the River Nile",
subtitle = paste0("Measurements of the annual flow of the river Nile at Aswan (formerly Assuan), 1871â€“1970,","\n" ,"in 10^8 m^3"),
x = "Year", y = "Flow (10^8 cu.m)") +
theme_bw() + theme(legend.position = "bottom",
legend.box.background = element_rect(colour = "black"))
ggsave("image.png")
graphics.off()
rm(list = ls())
gc()
version
library(tidyverse)
library(tsibble)
library(gghighlight)
ToothGrowth |> head()
ToothGrowth |> class()
ToothGrowth |> dim()
df <- ToothGrowth
df |> head()
df |>
ggplot(aes(supp, len)) +
geom_point()
df |>
ggplot(aes(supp, len)) +
geom_boxplot(alpha = 0.5) +
geom_point()
df |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_point()
df |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_jitter(alpha = 0.7, width = 0.2)
df1 <-
df |>
group_by(supp) |>
mutate(min = min(len), max = max(len))
df1 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2)
df2 <-
df |>
group_by(supp, dose) |>
mutate(min = min(len), max = max(len))
df2 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2) +
facet_wrap(vars(dose))
dose_status <- c("0.5" = "0.5mg/day", "1" = "1.0mg/day", "2" = "2.0mg/day")
df2 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2) +
facet_wrap(vars(dose), labeller = labeller(dose = dose_status)) +
labs(title = "The Effect of Vitamin C on Tooth Growth in Guinea Pigs",
subtitle = paste0("The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs.","\n",
"Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day)","\n",
"by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC)."),
x = "Supplement type", y = "Tooth length", color = "Supplement type") +
theme_bw() + theme(legend.position = "bottom")
graphics.off()
rm(list = ls())
gc()
version
library(tidyverse)
library(tsibble)
library(gghighlight)
ToothGrowth |> head()
ToothGrowth |> class()
ToothGrowth |> dim()
df <- ToothGrowth
df |> head()
df |>
ggplot(aes(supp, len)) +
geom_point()
df |>
ggplot(aes(supp, len)) +
geom_boxplot(alpha = 0.5) +
geom_point()
df |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_point()
df |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_jitter(alpha = 0.7, width = 0.2)
df1 <-
df |>
group_by(supp) |>
mutate(min = min(len), max = max(len))
df1 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2)
df2 <-
df |>
group_by(supp, dose) |>
mutate(min = min(len), max = max(len))
df2 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2) +
facet_wrap(vars(dose))
dose_status <- c("0.5" = "0.5mg/day", "1" = "1.0mg/day", "2" = "2.0mg/day")
df2 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2) +
facet_wrap(vars(dose), labeller = labeller(dose = dose_status)) +
labs(title = "The Effect of Vitamin C on Tooth Growth in Guinea Pigs",
subtitle = paste0("The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs.","\n",
"Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day)","\n",
"by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC)."),
x = "Supplement type", y = "Tooth length", color = "Supplement type") +
theme_bw() + theme(legend.position = "bottom")
graphics.off()
rm(list = ls())
gc()
version
library(tidyverse)
library(tsibble)
library(gghighlight)
ToothGrowth |> head()
ToothGrowth |> class()
ToothGrowth |> dim()
df <- ToothGrowth
df |> head()
df |>
ggplot(aes(supp, len)) +
geom_point()
df |>
ggplot(aes(supp, len)) +
geom_boxplot(alpha = 0.5) +
geom_point()
df |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_point()
df |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_jitter(alpha = 0.7, width = 0.2)
df1 <-
df |>
group_by(supp) |>
mutate(min = min(len), max = max(len))
df1 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2)
df2 <-
df |>
group_by(supp, dose) |>
mutate(min = min(len), max = max(len))
df2 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2) +
facet_wrap(vars(dose))
dose_status <- c("0.5" = "0.5mg/day", "1" = "1.0mg/day", "2" = "2.0mg/day")
df2 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2) +
facet_wrap(vars(dose), labeller = labeller(dose = dose_status)) +
labs(title = "The Effect of Vitamin C on Tooth Growth in Guinea Pigs",
subtitle = paste0("The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs.","\n",
"Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day)","\n",
"by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC)."),
x = "Supplement type", y = "Tooth length", color = "Supplement type") +
theme_bw() + theme(legend.position = "bottom")
ggsave("image.png")
graphics.off()
rm(list = ls())
gc()
version
library(tidyverse)
CO2 |> head()
CO2 |> class()
CO2 |> dim()
unique(CO2[,1:3])
plot(CO2)
CO2 |>
ggplot(aes(conc, uptake)) +
geom_point()
CO2 |>
ggplot(aes(conc, uptake)) +
geom_path() +
geom_point(shape = 21, fill = "white", color = "black") +
facet_wrap(vars(Plant), nrow = 1)
CO2 |>
ggplot(aes(conc, uptake, color = Plant)) +
geom_path(show.legend = FALSE) +
geom_point(aes(color = Plant), shape = 21, fill = "white", show.legend = FALSE) +
facet_wrap(vars(Plant), nrow = 1) +
scale_x_continuous(limits = c(0,1200), breaks = seq(0,1200,400)) +
labs(title = "Carbon Dioxide Uptake in Grass Plants",
subtitle = paste0("The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance","\n" ,
"of the grass species Echinochloa crus-galli."),
x = "Ambient carbon dioxide concentrations (mL/L)",
y = "Carbon dioxide uptake rates (umol/sq.m sec)",
color = "Legend") +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
CO2 |>
ggplot(aes(conc, uptake, group = Plant, label = Plant)) +
# path color sets by color name then determine color in scale_color_manual()
geom_path(data = subset(CO2, Plant != "Mn1"), aes(color = "Others"), linewidth = 1, lty = 2) +
geom_path(data = subset(CO2, Plant == "Mn1"), aes(color = "Mn1"), linewidth = 1, lty = 1) +
# point color determines in geom_point() directly
geom_point(data = subset(CO2, Plant != "Mn1"), shape = 21, fill = "white", color = "gray") +
geom_point(data = subset(CO2, Plant == "Mn1"), shape = 21, fill = "white", color = "coral") +
scale_color_manual(values = c("Others" = "gray80","Mn1" = "coral")) +
labs(title = "Carbon Dioxide Uptake in Grass Plants",
subtitle = paste0("The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance","\n" ,
"of the grass species Echinochloa crus-galli."),
x = "Ambient carbon dioxide concentrations (mL/L)",
y = "Carbon dioxide uptake rates (umol/sq.m sec)",
color = "Legend") +
theme_bw() +
theme(legend.position = c(0.9, 0.15), # Caution!!! it is relative position ex) 0: left end ~ 1: right end
legend.background = element_rect(fill = "white"),
legend.box.background = element_rect(color = "black"))
df <-
CO2 |>
mutate(category = case_when(str_detect(Plant, "Qn") ~ "Qn",
str_detect(Plant, "Qc") ~ "Qc",
str_detect(Plant, "Mn") ~ "Mn",
str_detect(Plant, "Mc") ~ "Mc",
.default = "Unknown"))
df |> head()
df |>
ggplot(aes(conc, uptake, color = Plant)) +
geom_path(show.legend = FALSE) +
geom_point(aes(color = Plant), shape = 21, fill = "white", show.legend = FALSE) +
facet_wrap(vars(category), nrow = 1) +
labs(title = "Carbon Dioxide Uptake in Grass Plants",
subtitle = paste0("The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance","\n" ,
"of the grass species Echinochloa crus-galli."),
x = "Ambient carbon dioxide concentrations (mL/L)",
y = "Carbon dioxide uptake rates (umol/sq.m sec)",
color = "Legend") +
theme_bw()
df |>
ggplot(aes(conc, uptake, color = Plant)) +
geom_path(show.legend = FALSE) +
geom_point(aes(color = Plant), shape = 21, fill = "white", show.legend = FALSE) +
facet_wrap(vars(category, Plant), ncol = 4, dir = "v", labeller = labeller(.multi_line = FALSE)) +
labs(title = "Carbon Dioxide Uptake in Grass Plants",
subtitle = paste0("The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance","\n" ,
"of the grass species Echinochloa crus-galli."),
x = "Ambient carbon dioxide concentrations (mL/L)",
y = "Carbon dioxide uptake rates (umol/sq.m sec)",
color = "Legend") +
theme_bw()
ggsave("image.png")
graphics.off()
rm(list = ls())
gc()
version
library(tidyverse)
CO2 |> head()
CO2 |> class()
CO2 |> dim()
unique(CO2[,1:3])
plot(CO2)
CO2 |>
ggplot(aes(conc, uptake)) +
geom_point()
CO2 |>
ggplot(aes(conc, uptake)) +
geom_path() +
geom_point(shape = 21, fill = "white", color = "black") +
facet_wrap(vars(Plant), nrow = 1)
CO2 |>
ggplot(aes(conc, uptake, color = Plant)) +
geom_path(show.legend = FALSE) +
geom_point(aes(color = Plant), shape = 21, fill = "white", show.legend = FALSE) +
facet_wrap(vars(Plant), nrow = 1) +
scale_x_continuous(limits = c(0,1200), breaks = seq(0,1200,400)) +
labs(title = "Carbon Dioxide Uptake in Grass Plants",
subtitle = paste0("The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance","\n" ,
"of the grass species Echinochloa crus-galli."),
x = "Ambient carbon dioxide concentrations (mL/L)",
y = "Carbon dioxide uptake rates (umol/sq.m sec)",
color = "Legend") +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
CO2 |>
ggplot(aes(conc, uptake, group = Plant, label = Plant)) +
# path color sets by color name then determine color in scale_color_manual()
geom_path(data = subset(CO2, Plant != "Mn1"), aes(color = "Others"), linewidth = 1, lty = 2) +
geom_path(data = subset(CO2, Plant == "Mn1"), aes(color = "Mn1"), linewidth = 1, lty = 1) +
# point color determines in geom_point() directly
geom_point(data = subset(CO2, Plant != "Mn1"), shape = 21, fill = "white", color = "gray") +
geom_point(data = subset(CO2, Plant == "Mn1"), shape = 21, fill = "white", color = "coral") +
scale_color_manual(values = c("Others" = "gray80","Mn1" = "coral")) +
labs(title = "Carbon Dioxide Uptake in Grass Plants",
subtitle = paste0("The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance","\n" ,
"of the grass species Echinochloa crus-galli."),
x = "Ambient carbon dioxide concentrations (mL/L)",
y = "Carbon dioxide uptake rates (umol/sq.m sec)",
color = "Legend") +
theme_bw() +
theme(legend.position = c(0.9, 0.15), # Caution!!! it is relative position ex) 0: left end ~ 1: right end
legend.background = element_rect(fill = "white"),
legend.box.background = element_rect(color = "black"))
df <-
CO2 |>
mutate(category = case_when(str_detect(Plant, "Qn") ~ "Qn",
str_detect(Plant, "Qc") ~ "Qc",
str_detect(Plant, "Mn") ~ "Mn",
str_detect(Plant, "Mc") ~ "Mc",
.default = "Unknown"))
df |> head()
df |>
ggplot(aes(conc, uptake, color = Plant)) +
geom_path(show.legend = FALSE) +
geom_point(aes(color = Plant), shape = 21, fill = "white", show.legend = FALSE) +
facet_wrap(vars(category), nrow = 1) +
labs(title = "Carbon Dioxide Uptake in Grass Plants",
subtitle = paste0("The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance","\n" ,
"of the grass species Echinochloa crus-galli."),
x = "Ambient carbon dioxide concentrations (mL/L)",
y = "Carbon dioxide uptake rates (umol/sq.m sec)",
color = "Legend") +
theme_bw()
df |>
ggplot(aes(conc, uptake, color = Plant)) +
geom_path(show.legend = FALSE) +
geom_point(aes(color = Plant), shape = 21, fill = "white", show.legend = FALSE) +
facet_wrap(vars(category, Plant), ncol = 4, dir = "v", labeller = labeller(.multi_line = FALSE)) +
labs(title = "Carbon Dioxide Uptake in Grass Plants",
subtitle = paste0("The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance","\n" ,
"of the grass species Echinochloa crus-galli."),
x = "Ambient carbon dioxide concentrations (mL/L)",
y = "Carbon dioxide uptake rates (umol/sq.m sec)",
color = "Legend") +
theme_bw()
ggsave("image.png")
graphics.off()
rm(list = ls())
gc()
version
library(tidyverse)
library(tsibble)
library(gghighlight)
ToothGrowth |> head()
ToothGrowth |> class()
ToothGrowth |> dim()
df <- ToothGrowth
df |> head()
df |>
ggplot(aes(supp, len)) +
geom_point()
df |>
ggplot(aes(supp, len)) +
geom_boxplot(alpha = 0.5) +
geom_point()
df |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_point()
df |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_jitter(alpha = 0.7, width = 0.2)
df1 <-
df |>
group_by(supp) |>
mutate(min = min(len), max = max(len))
df1 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2)
df2 <-
df |>
group_by(supp, dose) |>
mutate(min = min(len), max = max(len))
df2 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2) +
facet_wrap(vars(dose))
dose_status <- c("0.5" = "0.5mg/day", "1" = "1.0mg/day", "2" = "2.0mg/day")
df2 |>
ggplot(aes(supp, len, color = supp)) +
geom_boxplot(alpha = 0.5, show.legend = FALSE) +
geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +
geom_jitter(alpha = 0.7, width = 0.2) +
facet_wrap(vars(dose), labeller = labeller(dose = dose_status)) +
labs(title = "The Effect of Vitamin C on Tooth Growth in Guinea Pigs",
subtitle = paste0("The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs.","\n",
"Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day)","\n",
"by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC)."),
x = "Supplement type", y = "Tooth length", color = "Supplement type") +
theme_bw() + theme(legend.position = "bottom")
ggsave("image.png")
