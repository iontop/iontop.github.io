{
  "hash": "cbc6069a617dc1b625d7402a847154cd",
  "result": {
    "markdown": "---\ntitle: \"Box plot with ToothGrowth\"\nauthor: \"Sean Ahn\"\ndate: \"2023-08-26\"\ncategories: [ggplot, visualization]\nimage: \"image.png\"\n---\n\n\nIn this post, I've done a boxplot with ToothGrowth dataset. As you know, box plot is one of the most useful plot to visualize the dataset. But I don't explain what box plot. If you want to know what box plot is, you can see the [wiki](https://en.wikipedia.org/wiki/Box_plot).\n\n\n## Initializing\n\nI usually use the following code for initialization. If you don't want to remove plots and/or variables, you can skip it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraphics.off()\nrm(list = ls())\ngc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          used (Mb) gc trigger (Mb) limit (Mb) max used (Mb)\nNcells  578462 30.9    1318111 70.4         NA   669274 35.8\nVcells 1056852  8.1    8388608 64.0      16384  1851504 14.2\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nversion\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               _                           \nplatform       aarch64-apple-darwin20      \narch           aarch64                     \nos             darwin20                    \nsystem         aarch64, darwin20           \nstatus                                     \nmajor          4                           \nminor          3.1                         \nyear           2023                        \nmonth          06                          \nday            16                          \nsvn rev        84548                       \nlanguage       R                           \nversion.string R version 4.3.1 (2023-06-16)\nnickname       Beagle Scouts               \n```\n:::\n:::\n\n\n## Loading Useful Library\n\nWe want to use as few packages (some might call them \"libraries\") as possible. If possible, I'm going to use only the **tidyverse** package. [Tidyverse](https://www.tidyverse.org) is one of the most famous packages in R programming, and it's really powerful and useful.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n\n## Select Dataset\n\nWhen I write posts in my blog, I use the built-in dataset because I don't want the reader to suffer by having to find the data from somewhere else.\n\nThe dataset I'll be using in this post is shown below ⬇️ .\n\n<br>\n\n**The Effect of Vitamin C on Tooth Growth in Guinea Pigs**\n\n### Description\n\nThe response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).\n\n### Usage\n\nToothGrowth\n\n### Format\n\nA data frame with 60 observations on 3 variables.\n\n[,1]\tlen\tnumeric\tTooth length.   \n[,2]\tsupp\tfactor\tSupplement type (VC or OJ).  \n[,3]\tdose\tnumeric\tDose in milligrams/day. \n\nAs like other posts, I check what is in dataset and how big dataset is.  \n\nNothing special 😎\n\n\n::: {.cell}\n\n```{.r .cell-code}\nToothGrowth |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   len supp dose\n1  4.2   VC  0.5\n2 11.5   VC  0.5\n3  7.3   VC  0.5\n4  5.8   VC  0.5\n5  6.4   VC  0.5\n6 10.0   VC  0.5\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nToothGrowth |> class()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"data.frame\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nToothGrowth |> dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 60  3\n```\n:::\n:::\n\n\n## Visualization\n\nAll right! First of all, dataset copied into 'df' variable to preserve original data.  \n\nIt is fine for now because I work with built-in dataset. However, I strongly recommend copy if you work with your own dataset. It will help you saving time or work done properly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- ToothGrowth\ndf |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   len supp dose\n1  4.2   VC  0.5\n2 11.5   VC  0.5\n3  7.3   VC  0.5\n4  5.8   VC  0.5\n5  6.4   VC  0.5\n6 10.0   VC  0.5\n```\n:::\n:::\n\n\nNow I make simple dotplot. it is hard to understand what data mean. but readers can notice there are distribution on something.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(supp, len)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nI overlay boxplot with dotplot. it can make readers understand easily because box plot shows lots of information graphically. (e.g median, first quartile, third quartile, etc.). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(supp, len)) +\n  geom_boxplot(alpha = 0.5) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nI colored data respectively to distinguish easily. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nI replace to `geom_jitter()` because some of data is overplotting when I used `geom_point()`.  \n\nIt looks much better! 👍  \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_jitter(alpha = 0.7, width = 0.2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nto make whisker on boxplot, I added `min` and `max` column with `mutate()` function. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 <- \n  df |> \n  group_by(supp) |> \n  mutate(min = min(len), max = max(len))\n```\n:::\n\n\nThen `goem_errorbar()` shows minimum value and maximum value as like below.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +\n  geom_jitter(alpha = 0.7, width = 0.2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nIn fact, this boxplot is pretty good enough. To make the boxplot into a dose-dependent plot of tooth growth, I create a new variable named df2.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 <- \n  df |> \n  group_by(supp, dose) |> \n  mutate(min = min(len), max = max(len))\n```\n:::\n\n\nIf I make the plot in the same way as before, and use the `facet_warp()` function to draw a boxplot by dose, I'll get something like this. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +\n  geom_jitter(alpha = 0.7, width = 0.2) +\n  facet_wrap(vars(dose))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nAll most done now. to specify what tab means, I change tab names with `labeller()` function. and I add an explanation in plot, decorate theme.\n\nI finally got it. 🍺\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndose_status <- c(\"0.5\" = \"0.5mg/day\", \"1\" = \"1.0mg/day\", \"2\" = \"2.0mg/day\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +\n  geom_jitter(alpha = 0.7, width = 0.2) +\n  facet_wrap(vars(dose), labeller = labeller(dose = dose_status)) +\n  labs(title = \"The Effect of Vitamin C on Tooth Growth in Guinea Pigs\",\n       subtitle = paste0(\"The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs.\",\"\\n\", \n                         \"Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day)\",\"\\n\",\n                         \"by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).\"),\n       x = \"Supplement type\", y = \"Tooth length\", color = \"Supplement type\") +\n  theme_bw() + theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n\n<div class=\"right\">\n__END OF POST__\n</div>\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}