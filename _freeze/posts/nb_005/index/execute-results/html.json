{
  "hash": "af9786dd622b269c194895f7e92bdd71",
  "result": {
    "markdown": "---\ntitle: \"Box plot with ggplot2\"\nauthor: \"Junho (Sean) Ahn\"\ndate: \"2023-08-26\"\ncategories: [ggplot, visualization]\nimage: \"image.png\"\n---\n\n\n## Initializing\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraphics.off()\nrm(list = ls())\ngc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          used (Mb) gc trigger (Mb) limit (Mb) max used (Mb)\nNcells  575919 30.8    1310780 70.1         NA   669405 35.8\nVcells 1050829  8.1    8388608 64.0      16384  1851688 14.2\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nversion\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               _                           \nplatform       aarch64-apple-darwin20      \narch           aarch64                     \nos             darwin20                    \nsystem         aarch64, darwin20           \nstatus                                     \nmajor          4                           \nminor          3.1                         \nyear           2023                        \nmonth          06                          \nday            16                          \nsvn rev        84548                       \nlanguage       R                           \nversion.string R version 4.3.1 (2023-06-16)\nnickname       Beagle Scouts               \n```\n:::\n:::\n\n\n## Loading Useful Library\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(tsibble)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'tsibble'\n\nThe following object is masked from 'package:lubridate':\n\n    interval\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(gghighlight)\n```\n:::\n\n\n## Select Dataset\n\n**The Effect of Vitamin C on Tooth Growth in Guinea Pigs**\n\n### Description\n\nThe response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).\n\n### Usage\n\nToothGrowth\n\n### Format\n\nA data frame with 60 observations on 3 variables.\n\n[,1]\tlen\tnumeric\tTooth length\n[,2]\tsupp\tfactor\tSupplement type (VC or OJ).\n[,3]\tdose\tnumeric\tDose in milligrams/day\n\n\n::: {.cell}\n\n```{.r .cell-code}\nToothGrowth |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   len supp dose\n1  4.2   VC  0.5\n2 11.5   VC  0.5\n3  7.3   VC  0.5\n4  5.8   VC  0.5\n5  6.4   VC  0.5\n6 10.0   VC  0.5\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nToothGrowth |> class()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"data.frame\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nToothGrowth |> dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 60  3\n```\n:::\n:::\n\n\n## Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- ToothGrowth\ndf |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   len supp dose\n1  4.2   VC  0.5\n2 11.5   VC  0.5\n3  7.3   VC  0.5\n4  5.8   VC  0.5\n5  6.4   VC  0.5\n6 10.0   VC  0.5\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(supp, len)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(supp, len)) +\n  geom_boxplot(alpha = 0.5) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_jitter(alpha = 0.7, width = 0.2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nThe standard error is just the standard deviation divided by the square root of the sample size. So you can easily make your own function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 <- \n  df |> \n  group_by(supp) |> \n  mutate(min = min(len), max = max(len))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +\n  geom_jitter(alpha = 0.7, width = 0.2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 <- \n  df |> \n  group_by(supp, dose) |> \n  mutate(min = min(len), max = max(len))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +\n  geom_jitter(alpha = 0.7, width = 0.2) +\n  facet_wrap(vars(dose))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndose_status <- c(\"0.5\" = \"0.5mg/day\", \"1\" = \"1.0mg/day\", \"2\" = \"2.0mg/day\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 |> \n  ggplot(aes(supp, len, color = supp)) +\n  geom_boxplot(alpha = 0.5, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = min, ymax = max), alpha = 0.5) +\n  geom_jitter(alpha = 0.7, width = 0.2) +\n  facet_wrap(vars(dose), labeller = labeller(dose = dose_status)) +\n  labs(title = \"The Effect of Vitamin C on Tooth Growth in Guinea Pigs\",\n       subtitle = paste0(\"The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs.\",\"\\n\", \n                         \"Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day)\",\"\\n\",\n                         \"by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).\"),\n       x = \"Supplement type\", y = \"Tooth length\", color = \"Supplement type\") +\n  theme_bw() + theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}