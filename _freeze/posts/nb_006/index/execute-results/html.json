{
  "hash": "13c50226216cc5123911a9fbcf64f982",
  "result": {
    "markdown": "---\ntitle: \"Line plot with CO2\"\nauthor: \"Junho (Sean) Ahn\"\ndate: \"2023-08-26\"\ncategories: [ggplot, visualization]\nimage: \"image.png\"\n---\n\n\n## Initializing\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraphics.off()\nrm(list = ls())\ngc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          used (Mb) gc trigger (Mb) limit (Mb) max used (Mb)\nNcells  575886 30.8    1310684   70         NA   669408 35.8\nVcells 1051738  8.1    8388608   64      16384  1851569 14.2\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nversion\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               _                           \nplatform       aarch64-apple-darwin20      \narch           aarch64                     \nos             darwin20                    \nsystem         aarch64, darwin20           \nstatus                                     \nmajor          4                           \nminor          3.1                         \nyear           2023                        \nmonth          06                          \nday            16                          \nsvn rev        84548                       \nlanguage       R                           \nversion.string R version 4.3.1 (2023-06-16)\nnickname       Beagle Scouts               \n```\n:::\n:::\n\n\n## Loading Useful Library\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n\n## Select Dataset\n\n**Carbon Dioxide Uptake in Grass Plants**\n\n### Description\nThe CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance of the grass species Echinochloa crus-galli.\n\n### Usage\nCO2\n\n### Format\nAn object of class c(\"nfnGroupedData\", \"nfGroupedData\", \"groupedData\", \"data.frame\") containing the following columns:\n\nPlant\nan ordered factor with levels Qn1 < Qn2 < Qn3 < ... < Mc1 giving a unique identifier for each plant.\n\nType\na factor with levels Quebec Mississippi giving the origin of the plant\n\nTreatment\na factor with levels nonchilled chilled\n\nconc\na numeric vector of ambient carbon dioxide concentrations (mL/L).\n\nuptake\na numeric vector of carbon dioxide uptake rates ($\\mu$mol/$m^2$sec).\n\n### Details\nThe $CO_2$ uptake of six plants from Quebec and six plants from Mississippi was measured at several levels of ambient $CO_2$ concentration. Half the plants of each type were chilled overnight before the experiment was conducted.\n\nThis dataset was originally part of package nlme, and that has methods (including for [, as.data.frame, plot and print) for its grouped-data classes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2 |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Plant   Type  Treatment conc uptake\n1   Qn1 Quebec nonchilled   95   16.0\n2   Qn1 Quebec nonchilled  175   30.4\n3   Qn1 Quebec nonchilled  250   34.8\n4   Qn1 Quebec nonchilled  350   37.2\n5   Qn1 Quebec nonchilled  500   35.3\n6   Qn1 Quebec nonchilled  675   39.2\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2 |> class()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"nfnGroupedData\" \"nfGroupedData\"  \"groupedData\"    \"data.frame\"    \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2 |> dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 84  5\n```\n:::\n:::\n\n\n## Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(CO2[,1:3])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Plant        Type  Treatment\n1    Qn1      Quebec nonchilled\n8    Qn2      Quebec nonchilled\n15   Qn3      Quebec nonchilled\n22   Qc1      Quebec    chilled\n29   Qc2      Quebec    chilled\n36   Qc3      Quebec    chilled\n43   Mn1 Mississippi nonchilled\n50   Mn2 Mississippi nonchilled\n57   Mn3 Mississippi nonchilled\n64   Mc1 Mississippi    chilled\n71   Mc2 Mississippi    chilled\n78   Mc3 Mississippi    chilled\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(CO2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2 |> \n  ggplot(aes(conc, uptake)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2 |> \n  ggplot(aes(conc, uptake)) +\n  geom_path() +\n  geom_point(shape = 21, fill = \"white\", color = \"black\") +\n  facet_wrap(vars(Plant), nrow = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2 |> \n  ggplot(aes(conc, uptake, color = Plant)) +\n  geom_path(show.legend = FALSE) +\n  geom_point(aes(color = Plant), shape = 21, fill = \"white\", show.legend = FALSE) +\n  facet_wrap(vars(Plant), nrow = 1) +\n  scale_x_continuous(limits = c(0,1200), breaks = seq(0,1200,400)) +\n  labs(title = \"Carbon Dioxide Uptake in Grass Plants\",\n       subtitle = paste0(\"The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance\",\"\\n\" ,\n                         \"of the grass species Echinochloa crus-galli.\"),\n       x = \"Ambient carbon dioxide concentrations (mL/L)\",\n       y = \"Carbon dioxide uptake rates (umol/sq.m sec)\",\n       color = \"Legend\") +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2 |> \n  ggplot(aes(conc, uptake, group = Plant, label = Plant)) +\n  # path color sets by color name then determine color in scale_color_manual()\n  geom_path(data = subset(CO2, Plant != \"Mn1\"), aes(color = \"Others\"), linewidth = 1, lty = 2) +\n  geom_path(data = subset(CO2, Plant == \"Mn1\"), aes(color = \"Mn1\"), linewidth = 1, lty = 1) +\n  # point color determines in geom_point() directly\n  geom_point(data = subset(CO2, Plant != \"Mn1\"), shape = 21, fill = \"white\", color = \"gray\") +\n  geom_point(data = subset(CO2, Plant == \"Mn1\"), shape = 21, fill = \"white\", color = \"coral\") +\n  scale_color_manual(values = c(\"Others\" = \"gray80\",\"Mn1\" = \"coral\")) +\n  labs(title = \"Carbon Dioxide Uptake in Grass Plants\",\n       subtitle = paste0(\"The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance\",\"\\n\" ,\n                         \"of the grass species Echinochloa crus-galli.\"),\n       x = \"Ambient carbon dioxide concentrations (mL/L)\",\n       y = \"Carbon dioxide uptake rates (umol/sq.m sec)\",\n       color = \"Legend\") +\n  theme_bw() + \n  theme(legend.position = c(0.9, 0.15), # Caution!!! it is relative position ex) 0: left end ~ 1: right end\n        legend.background = element_rect(fill = \"white\"),\n        legend.box.background = element_rect(color = \"black\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- \n  CO2 |> \n  mutate(category = case_when(str_detect(Plant, \"Qn\") ~ \"Qn\",\n                              str_detect(Plant, \"Qc\") ~ \"Qc\",\n                              str_detect(Plant, \"Mn\") ~ \"Mn\",\n                              str_detect(Plant, \"Mc\") ~ \"Mc\",\n                              .default = \"Unknown\"))\ndf |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Plant   Type  Treatment conc uptake category\n1   Qn1 Quebec nonchilled   95   16.0       Qn\n2   Qn1 Quebec nonchilled  175   30.4       Qn\n3   Qn1 Quebec nonchilled  250   34.8       Qn\n4   Qn1 Quebec nonchilled  350   37.2       Qn\n5   Qn1 Quebec nonchilled  500   35.3       Qn\n6   Qn1 Quebec nonchilled  675   39.2       Qn\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(conc, uptake, color = Plant)) +\n  geom_path(show.legend = FALSE) +\n  geom_point(aes(color = Plant), shape = 21, fill = \"white\", show.legend = FALSE) +\n  facet_wrap(vars(category), nrow = 1) +\n  labs(title = \"Carbon Dioxide Uptake in Grass Plants\",\n       subtitle = paste0(\"The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance\",\"\\n\" ,\n                         \"of the grass species Echinochloa crus-galli.\"),\n       x = \"Ambient carbon dioxide concentrations (mL/L)\",\n       y = \"Carbon dioxide uptake rates (umol/sq.m sec)\",\n       color = \"Legend\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(conc, uptake, color = Plant)) +\n  geom_path(show.legend = FALSE) +\n  geom_point(aes(color = Plant), shape = 21, fill = \"white\", show.legend = FALSE) +\n  facet_wrap(vars(category, Plant), ncol = 4, dir = \"v\", labeller = labeller(.multi_line = FALSE)) +\n  labs(title = \"Carbon Dioxide Uptake in Grass Plants\",\n       subtitle = paste0(\"The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance\",\"\\n\" ,\n                         \"of the grass species Echinochloa crus-galli.\"),\n       x = \"Ambient carbon dioxide concentrations (mL/L)\",\n       y = \"Carbon dioxide uptake rates (umol/sq.m sec)\",\n       color = \"Legend\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n\n<div class=\"right\">\n__END OF POST__\n</div>\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}